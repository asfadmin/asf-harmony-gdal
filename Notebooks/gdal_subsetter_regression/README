The GDAL Subsetter regression tests use a Jupyter Notebook and were developed within a pipenv virtual environment.

Install pipenv:
pip install pipenv

Spawn a shell in a virtual environment:
pipenv shell

Download the github repo asf-harmony-gdal:
https://github.com/asfadmin/asf-harmony-gdal.git

Install Jupyter Notebook from within Notebooks:
pipenv install jupyter

Install dependencies from Pipfile.lock in Notebooks/gdal_subsetter_regression:

pipenv install --ignore-pipfile

Authentication:
The harmony_requests.py module uses EDL URS credentials in a .netrc file.
(For info: https://support.earthdata.nasa.gov/index.php?/Knowledgebase/Article/View/43/21/how-to-access-urs-gated-data-with-curl-and-wget)

Run Jupyter Notebook from 'Notebooks/gdal_subsetter_regression':
jupyter notebook

In the Jupyter Notebook open 'GDAL_Subsetter_Regression.ipynb'
Run the first cell to select the environment (default is uat)
Run the second cell to perform regression tests against the S1 InSAR (GRFN) collection.
Run the third cell to perform regression tests against the UAVSAR POLSAR PAULI collection.
Run the fourth cell to perform regression tests against the AVNIR-2 collection.

Program flow overview (how it all works):
1. The user selects an environment in the first cell.
2. The base harmony URL is constructed using get_base_url_info.py based on the environment selected in the first cell and the collection, which depends on which subsequent cell was run. 
3. For the chosen collection, the code in the cell loops through a list of dictionaries in <collection>_info.py. The dictionaries each contain information included in a Harmony request as well as expected values for the subsequent test assertions.
4. After each Harmony request is run, information is extracted from the resulting product metadata with get_product_info.py, a test file with assertions based on the expected results and product information is constructed with write_testfile.py or write_filetype_test.py, and pytest is used to run the tests.
5. Some file handling is conducted in order to keep the test files around for a summary run at the end of the cell, then all temporary files are removed with cleanup.py.

