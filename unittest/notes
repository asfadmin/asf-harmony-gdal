1. unit test the transform.py locally

requrements:

a. connect ASF VPN-full

b. in the har-gdal-env environemnt (conda activate har-gdal-env)

conda activate har-gdal-env

c. setup network and environment

cd ~/projects/work/harmony-curr/harmony

bin/create-docker-network.bash

bin/create_local_env.bash

run the test locally

cd ~/projects/work/harmony-curr/gdal-subsetter/unittest

./auto_test.bash message_file output_dir

2. run test in the gdal-subsetter docker

bring up the gdal-subsetter container

connect to ASF VPN-FUll

cd harmony

bin/docker-network.bash

bin/run-localstack

docker ps #to get harmony/gdal-subsetter container_id

docker exec -it container_id bash

inside gdal-subsetter docker container

/home/unittest# ./auto_test.bash data/messages/message1 data/results/grfn-results/data


3. How to get message_string?

you need start harmony and local-stage-service

connect to ASF VPN-FUll

cd harmony

bin/docker-network.bash

bin/run-localstack

npm run satrt-dev


it is better run get_message.py in the docker 

docker ps

docker exec -it container_id bash

inside gdal-subsetter docker
 
python -m pdb get_message.py --harmony-action start --harmony-queue-url  http://0.0.0.0:4566/queue/harmony-gdal-queue --message-file file

--message-file is the output_message_file_name


run unitest in another way

docker run -it --entrypoint /bin/bash harmony/gdal-subsetter

cd unittest

./auto_test.bash data/messages/message1 data/results/grfn-results/data



